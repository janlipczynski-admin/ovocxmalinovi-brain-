<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Planowanie ZakupÃ³w i OpakowaÅ„ â€” OvocxMalinovi</title>
<script src="zuzycie-data.js"></script>
<script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --orange:#fa4211; --purple:#9013fe; --green:#16a34a; --blue:#2563eb; --yellow:#d97706;
  --grad:linear-gradient(135deg,#fa4211,#9013fe);
  --bg:#f7f7f5; --white:#fff;
  --border:#e8e6e1; --border2:#d8d5ce;
  --text:#1a1a18; --text-dim:#6b6b65; --text-muted:#a8a8a0;
  --surface2:#f2f0eb;
  --shadow:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --shadow-md:0 4px 16px rgba(0,0,0,.09),0 2px 4px rgba(0,0,0,.04);
  --shadow-lg:0 8px 32px rgba(0,0,0,.12),0 4px 8px rgba(0,0,0,.05);
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:'Plus Jakarta Sans',sans-serif;min-height:100vh;font-size:14px}

/* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 32px;background:var(--white);border-bottom:1px solid var(--border);
  position:sticky;top:0;z-index:200;box-shadow:var(--shadow);gap:12px
}
.back-btn{display:flex;align-items:center;gap:7px;text-decoration:none;color:var(--text-dim);font-size:13px;font-weight:500;transition:color .15s;white-space:nowrap}
.back-btn:hover{color:var(--orange)}
.h-center{display:flex;align-items:center;gap:8px;flex:1;justify-content:center}
.page-title{font-size:15px;font-weight:700}
.date-pill{font-family:'DM Mono',monospace;font-size:11px;color:var(--text-muted);background:var(--surface2);border:1px solid var(--border2);padding:3px 10px;border-radius:20px}

/* â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
main{padding:28px 32px 48px;max-width:1600px;margin:0 auto}

/* Page intro */
.page-intro{margin-bottom:28px}
.page-intro h1{font-size:22px;font-weight:700;margin-bottom:4px;letter-spacing:-.3px}
.page-intro p{font-size:13px;color:var(--text-dim);line-height:1.5}

/* â”€â”€ Dashboard grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dashboard-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:20px;
  align-items:start
}
@media(max-width:1100px){.dashboard-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:700px){.dashboard-grid{grid-template-columns:1fr}}

/* â”€â”€ Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dash-card{
  background:var(--white);border:1px solid var(--border);border-radius:16px;
  overflow:hidden;display:flex;flex-direction:column;
  box-shadow:var(--shadow);transition:box-shadow .2s,transform .2s
}
.dash-card:hover{box-shadow:var(--shadow-md);transform:translateY(-2px)}

/* Color accent strip on left */
.dash-card .card-top{position:relative;padding:20px 22px 16px 26px;border-bottom:1px solid var(--border)}
.dash-card .card-top::before{content:'';position:absolute;left:0;top:0;bottom:0;width:4px;border-radius:0}
.card-orange .card-top::before{background:var(--orange)}
.card-purple .card-top::before{background:var(--purple)}
.card-blue .card-top::before{background:var(--blue)}

.card-icon-wrap{width:42px;height:42px;border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:12px;flex-shrink:0}
.icon-orange{background:rgba(250,66,17,.1)}
.icon-purple{background:rgba(144,19,254,.1)}
.icon-blue{background:rgba(37,99,235,.1)}

.card-title{font-size:16px;font-weight:700;margin-bottom:3px;letter-spacing:-.2px}
.card-desc{font-size:12px;color:var(--text-dim);line-height:1.4;margin-bottom:10px}

.card-badge{
  display:inline-flex;align-items:center;gap:4px;
  font-family:'DM Mono',monospace;font-size:10px;
  padding:3px 9px;border-radius:20px;border:1px solid
}
.badge-active{background:rgba(250,66,17,.07);color:var(--orange);border-color:rgba(250,66,17,.2)}
.badge-purple{background:rgba(144,19,254,.07);color:var(--purple);border-color:rgba(144,19,254,.2)}
.badge-locked{background:rgba(22,163,74,.07);color:var(--green);border-color:rgba(22,163,74,.25)}
.badge-pending{background:var(--surface2);color:var(--text-muted);border-color:var(--border2)}

/* Card body */
.card-body{padding:18px 22px;flex:1}

/* Card footer */
.card-footer{
  padding:12px 22px;border-top:1px solid var(--border);
  background:var(--surface2);display:flex;gap:8px;flex-wrap:wrap;align-items:center
}

/* â”€â”€ Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn{
  display:inline-flex;align-items:center;gap:5px;
  padding:7px 14px;border-radius:8px;font-size:12px;
  font-family:'Plus Jakarta Sans',sans-serif;cursor:pointer;
  transition:all .15s;border:1px solid var(--border2);
  background:var(--white);color:var(--text-dim);font-weight:500;
  text-decoration:none;white-space:nowrap
}
.btn:hover{background:var(--surface2)}
.btn-orange{background:rgba(250,66,17,.07);color:var(--orange);border-color:rgba(250,66,17,.2)}
.btn-orange:hover{background:rgba(250,66,17,.12)}
.btn-purple{background:rgba(144,19,254,.07);color:var(--purple);border-color:rgba(144,19,254,.2)}
.btn-purple:hover{background:rgba(144,19,254,.12)}
.btn-blue{background:rgba(37,99,235,.07);color:var(--blue);border-color:rgba(37,99,235,.2)}
.btn-blue:hover{background:rgba(37,99,235,.12)}
.btn-sm{padding:5px 10px;font-size:11px}

/* â”€â”€ Sub-nav items â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sub-nav-item{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 14px;border:1px solid var(--border);border-radius:11px;
  margin-bottom:10px;text-decoration:none;color:var(--text);
  transition:all .2s;background:var(--white)
}
.sub-nav-item:hover{border-color:var(--border2);box-shadow:var(--shadow-md);transform:translateY(-1px)}
.sub-nav-item:last-child{margin-bottom:0}
.sub-nav-item.disabled{opacity:.5;pointer-events:none;cursor:default}

.sub-nav-left{display:flex;align-items:center;gap:11px}
.sub-nav-icon{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0}
.sni-purple{background:rgba(144,19,254,.1)}
.sni-muted{background:var(--surface2)}
.sni-orange{background:rgba(250,66,17,.1)}

.sub-nav-title{font-size:13px;font-weight:600;margin-bottom:2px}
.sub-nav-meta{font-size:11px;color:var(--text-muted)}

.sub-nav-right{display:flex;align-items:center;gap:8px;flex-shrink:0}
.sub-nav-arrow{font-size:16px;color:var(--text-muted)}

/* â”€â”€ Stan Magazynowy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.upload-zone{
  border:2px dashed var(--border2);border-radius:10px;
  padding:22px 16px;text-align:center;cursor:pointer;
  transition:all .15s;background:var(--surface2);margin-bottom:16px
}
.upload-zone:hover,.upload-zone.drag{border-color:var(--orange);background:rgba(250,66,17,.04)}
.upload-icon{font-size:26px;margin-bottom:6px}
.upload-text{font-size:12px;color:var(--text-dim);font-weight:500}
.upload-sub{font-size:11px;color:var(--text-muted);margin-top:3px}
input[type=file]#mag-file{display:none}

.empty-hint{text-align:center;padding:8px 0 0}
.empty-hint-icon{font-size:26px;margin-bottom:6px;opacity:.45}
.empty-hint-text{font-size:12px;color:var(--text-muted);line-height:1.5}

.stan-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:12px;gap:10px}
.stan-date-lbl{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);font-family:'DM Mono',monospace;margin-bottom:4px}
.stan-date-val{font-family:'DM Mono',monospace;font-size:14px;font-weight:700;color:var(--orange)}

/* Stats mini row */
.stats-mini{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px}
.stat-mini{background:var(--surface2);border-radius:8px;padding:9px 11px;border:1px solid var(--border)}
.stat-mini-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;font-family:'DM Mono',monospace;margin-bottom:3px}
.stat-mini-val{font-size:17px;font-weight:700;font-variant-numeric:tabular-nums;line-height:1}

/* Table */
.stan-table-wrap{overflow-x:auto;max-height:260px;overflow-y:auto;border:1px solid var(--border);border-radius:9px}
.stan-table{width:100%;border-collapse:collapse;font-size:12px}
.stan-table th{background:var(--surface2);color:var(--text-dim);font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;padding:7px 10px;text-align:left;position:sticky;top:0;border-bottom:1px solid var(--border);white-space:nowrap}
.stan-table td{padding:6px 10px;border-bottom:1px solid var(--border);white-space:nowrap;max-width:220px;overflow:hidden;text-overflow:ellipsis}
.stan-table tr:last-child td{border-bottom:none}
.stan-table tr:hover td{background:var(--surface2)}
.num-cell{font-family:'DM Mono',monospace;text-align:right}
.stan-table-footer{padding:6px 12px;background:var(--surface2);border-top:1px solid var(--border);font-size:11px;color:var(--text-muted);font-family:'DM Mono',monospace;border-radius:0 0 9px 9px}

/* â”€â”€ ZuÅ¼ycie â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.zuz-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:18px}
.zuz-stat{background:var(--surface2);border-radius:8px;padding:10px 12px;border:1px solid var(--border);text-align:center}
.zuz-stat-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;font-family:'DM Mono',monospace;margin-bottom:4px}
.zuz-stat-val{font-size:18px;font-weight:700;font-variant-numeric:tabular-nums}

/* â”€â”€ Planowanie placeholder â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.wip-box{
  border:1.5px dashed var(--border2);border-radius:11px;
  padding:22px 18px;text-align:center;background:var(--surface2);
  margin-bottom:18px
}
.wip-icon{font-size:30px;margin-bottom:8px;opacity:.7}
.wip-title{font-size:13px;font-weight:600;margin-bottom:4px}
.wip-text{font-size:11px;color:var(--text-muted);line-height:1.6}

.section-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--text-muted);margin-bottom:10px;font-family:'DM Mono',monospace}
</style>
</head>
<body>

<header>
  <a href="index.html" class="back-btn">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
    Centrum Operacyjne
  </a>
  <div class="h-center">
    <span class="page-title">Planowanie ZakupÃ³w i OpakowaÅ„</span>
  </div>
  <div class="date-pill" id="today-date"></div>
</header>

<main>
  <div class="page-intro">
    <h1>Dashboard zakupowy</h1>
    <p>ZarzÄ…dzaj stanami magazynowymi, analizuj zuÅ¼ycie materiaÅ‚Ã³w i planuj zakupy opakowaÅ„.</p>
  </div>

  <div class="dashboard-grid">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         KARTA 1 â€” Stan Magazynowy
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="dash-card card-orange">

      <div class="card-top">
        <div class="card-icon-wrap icon-orange">ğŸ“¦</div>
        <div class="card-title">Stan Magazynowy</div>
        <div class="card-desc">Stany opakowaÅ„ w magazynach na wybrany dzieÅ„ â€” wgraj plik z exportu StreamSoft</div>
        <div class="card-badge badge-active" id="stan-badge">Brak danych</div>
      </div>

      <div class="card-body">

        <!-- â”€â”€â”€ Stan: brak danych â”€â”€â”€ -->
        <div id="stan-empty">
          <div class="upload-zone" id="upload-zone"
               onclick="document.getElementById('mag-file').click()"
               ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
            <div class="upload-icon">ğŸ“‚</div>
            <div class="upload-text">Wgraj stany magazynowe</div>
            <div class="upload-sub">.xlsx Â· .xls &nbsp;Â·&nbsp; przeciÄ…gnij lub kliknij</div>
          </div>
          <input type="file" id="mag-file" accept=".xlsx,.xls" onchange="handleFile(event)">
          <div class="empty-hint">
            <div class="empty-hint-icon">ğŸ“‹</div>
            <div class="empty-hint-text">Brak wgranych danych.<br>Wgraj plik exportu ze StreamSoft.</div>
          </div>
        </div>

        <!-- â”€â”€â”€ Stan: dane wgrane â”€â”€â”€ -->
        <div id="stan-data" style="display:none">
          <div class="stan-header">
            <div>
              <div class="stan-date-lbl">Stan na dzieÅ„</div>
              <div class="stan-date-val" id="stan-date-val">â€”</div>
            </div>
            <button class="btn btn-sm" onclick="clearStan()">âœ• WyczyÅ›Ä‡</button>
          </div>
          <div class="stats-mini" id="stan-stats"></div>
          <div class="stan-table-wrap">
            <table class="stan-table">
              <thead id="stan-thead"></thead>
              <tbody id="stan-tbody"></tbody>
            </table>
          </div>
          <div class="stan-table-footer" id="stan-footer"></div>
        </div>

      </div>

      <div class="card-footer">
        <button class="btn btn-orange" onclick="document.getElementById('mag-file').click()">
          â†‘ Wgraj plik
        </button>
        <button class="btn btn-sm" id="stan-change-btn" style="display:none" onclick="document.getElementById('mag-file').click()">
          â†º ZmieÅ„
        </button>
        <span style="flex:1"></span>
        <span style="font-size:11px;color:var(--text-muted);font-family:'DM Mono',monospace">Excel / StreamSoft</span>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         KARTA 2 â€” ZuÅ¼ycie MateriaÅ‚Ã³w
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="dash-card card-purple">

      <div class="card-top">
        <div class="card-icon-wrap icon-purple">ğŸ“Š</div>
        <div class="card-title">ZuÅ¼ycie MateriaÅ‚Ã³w</div>
        <div class="card-desc">Analiza zuÅ¼ycia opakowaÅ„ per magazyn i materiaÅ‚ â€” dane historyczne i bieÅ¼Ä…ce</div>
        <div class="card-badge badge-purple" id="zuz-badge">Åadowanieâ€¦</div>
      </div>

      <div class="card-body">
        <div class="zuz-stats">
          <div class="zuz-stat">
            <div class="zuz-stat-label">Rekordy 2025</div>
            <div class="zuz-stat-val" id="zuz-cnt" style="color:var(--purple)">â€”</div>
          </div>
          <div class="zuz-stat">
            <div class="zuz-stat-label">Magazyny</div>
            <div class="zuz-stat-val" id="zuz-mag">â€”</div>
          </div>
          <div class="zuz-stat">
            <div class="zuz-stat-label">Typy mat.</div>
            <div class="zuz-stat-val" id="zuz-typy">â€”</div>
          </div>
        </div>

        <div class="section-label">Wybierz rok</div>

        <a href="zuzycie-2025.html" class="sub-nav-item">
          <div class="sub-nav-left">
            <div class="sub-nav-icon sni-purple">ğŸ“</div>
            <div>
              <div class="sub-nav-title">ZuÅ¼ycie 2025</div>
              <div class="sub-nav-meta" id="zuz-meta-2025">IVâ€“XI 2025 Â· Å‚adowanieâ€¦</div>
            </div>
          </div>
          <div class="sub-nav-right">
            <span class="card-badge badge-locked">ğŸ”’ Historyczne</span>
            <span class="sub-nav-arrow">â€º</span>
          </div>
        </a>

        <a href="#" class="sub-nav-item disabled">
          <div class="sub-nav-left">
            <div class="sub-nav-icon sni-muted">ğŸ“</div>
            <div>
              <div class="sub-nav-title">ZuÅ¼ycie 2026</div>
              <div class="sub-nav-meta">Dane bÄ™dÄ… uzupeÅ‚niane na bieÅ¼Ä…co</div>
            </div>
          </div>
          <div class="sub-nav-right">
            <span class="card-badge badge-pending">W przygotowaniu</span>
            <span class="sub-nav-arrow" style="opacity:.4">â€º</span>
          </div>
        </a>
      </div>

      <div class="card-footer">
        <a href="zuzycie-2025.html" class="btn btn-purple">ğŸ“Š OtwÃ³rz ZuÅ¼ycie 2025</a>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         KARTA 3 â€” Planowanie ZakupÃ³w
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="dash-card card-blue">

      <div class="card-top">
        <div class="card-icon-wrap icon-blue">ğŸ›’</div>
        <div class="card-title">Planowanie ZakupÃ³w</div>
        <div class="card-desc">Harmonogram zamÃ³wieÅ„, progi bezpieczeÅ„stwa i rekomendacje zakupowe</div>
        <div class="card-badge badge-pending">â³ W przygotowaniu</div>
      </div>

      <div class="card-body">
        <div class="wip-box">
          <div class="wip-icon">ğŸ—ï¸</div>
          <div class="wip-title">Sekcja w opracowaniu</div>
          <div class="wip-text">Opis i funkcjonalnoÅ›Ä‡ tej sekcji<br>sÄ… aktualnie definiowane przez Janka.</div>
        </div>

        <div class="section-label">PowiÄ…zane widoki</div>

        <a href="zakupy-klienci.html" class="sub-nav-item">
          <div class="sub-nav-left">
            <div class="sub-nav-icon sni-orange">ğŸ“¦</div>
            <div>
              <div class="sub-nav-title">Konfekcja per klient</div>
              <div class="sub-nav-meta">Zestawienie opakowaÅ„ wg klientÃ³w</div>
            </div>
          </div>
          <span class="sub-nav-arrow">â€º</span>
        </a>

        <a href="zakupy-harmonogram.html" class="sub-nav-item">
          <div class="sub-nav-left">
            <div class="sub-nav-icon sni-orange">ğŸ“…</div>
            <div>
              <div class="sub-nav-title">Harmonogram zakupÃ³w</div>
              <div class="sub-nav-meta">Terminy i planowane zamÃ³wienia</div>
            </div>
          </div>
          <span class="sub-nav-arrow">â€º</span>
        </a>
      </div>

      <div class="card-footer">
        <span class="btn" style="cursor:default;opacity:.55">â³ WkrÃ³tce dostÄ™pne</span>
      </div>
    </div>

  </div><!-- /dashboard-grid -->
</main>

<script>
// â”€â”€ Date display â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const today = new Date();
document.getElementById('today-date').textContent =
  today.toLocaleDateString('pl-PL',{day:'2-digit',month:'2-digit',year:'numeric'});

// â”€â”€ ZuÅ¼ycie stats (from zuzycie-data.js) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if (window.ZUZYCIE_DATA) {
  const rek = window.ZUZYCIE_DATA.rekordy;
  const mags  = new Set(rek.map(r => r.magazyn));
  const typy  = new Set(rek.map(r => r.typ_materialu));
  const mats  = new Set(rek.map(r => r.surowiec_nazwa));
  document.getElementById('zuz-cnt').textContent   = rek.length.toLocaleString('pl-PL');
  document.getElementById('zuz-mag').textContent   = mags.size;
  document.getElementById('zuz-typy').textContent  = typy.size;
  document.getElementById('zuz-badge').textContent = rek.length + ' rekordÃ³w Â· 2025';
  document.getElementById('zuz-meta-2025').textContent =
    window.ZUZYCIE_DATA.zakres + ' Â· ' + rek.length + ' rekordÃ³w Â· ' + mats.size + ' materiaÅ‚Ã³w';
}

// â”€â”€ Stan Magazynowy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LS_KEY = 'oxm_stan_mag_v2';

function handleDragOver(e)  { e.preventDefault(); document.getElementById('upload-zone').classList.add('drag'); }
function handleDragLeave()  { document.getElementById('upload-zone').classList.remove('drag'); }
function handleDrop(e) {
  e.preventDefault();
  document.getElementById('upload-zone').classList.remove('drag');
  const file = e.dataTransfer.files[0];
  if (file) processFile(file);
}
function handleFile(e) {
  const file = e.target.files[0];
  if (file) processFile(file);
}

function processFile(file) {
  const reader = new FileReader();
  reader.onload = function(ev) {
    try {
      const wb  = XLSX.read(ev.target.result, { type:'array' });
      const ws  = wb.Sheets[wb.SheetNames[0]];
      const raw = XLSX.utils.sheet_to_json(ws, { header:1, defval:'' });
      if (!raw.length) return;

      // Try to extract date from filename e.g. "Stany magazynowe na dn.25.02.2026.xlsx"
      const m = file.name.match(/(\d{1,2}[.\-\/]\d{1,2}[.\-\/]\d{4})/);
      const dateStr = m ? m[1].replace(/[-\/]/g, '.') : file.name.replace(/\.xlsx?$/i,'');

      const headers = raw[0].map(String).filter(Boolean);
      const rows    = raw.slice(1).filter(r => r.some(c => c !== ''));

      try { localStorage.setItem(LS_KEY, JSON.stringify({ date:dateStr, headers, rows:rows.slice(0,300) })); } catch(e){}
      renderStan(dateStr, headers, rows);
    } catch(err) {
      alert('BÅ‚Ä…d wczytywania pliku:\n' + err.message);
    }
  };
  reader.readAsArrayBuffer(file);
}

function renderStan(dateStr, headers, rows) {
  document.getElementById('stan-empty').style.display = 'none';
  document.getElementById('stan-data').style.display  = 'block';
  document.getElementById('stan-change-btn').style.display = 'inline-flex';
  document.getElementById('stan-date-val').textContent = dateStr;
  document.getElementById('stan-badge').textContent   = 'Stan: ' + dateStr;

  // Stats
  const numCols = headers.reduce((acc, h, i) => {
    if (rows.slice(0,10).some(r => typeof r[i] === 'number')) acc++;
    return acc;
  }, 0);
  document.getElementById('stan-stats').innerHTML = `
    <div class="stat-mini"><div class="stat-mini-label">Wiersze</div><div class="stat-mini-val" style="color:var(--orange)">${rows.length.toLocaleString('pl-PL')}</div></div>
    <div class="stat-mini"><div class="stat-mini-label">Kolumny</div><div class="stat-mini-val">${headers.length}</div></div>
    <div class="stat-mini"><div class="stat-mini-label">Num. kol.</div><div class="stat-mini-val">${numCols}</div></div>
  `;

  // Table â€” max 8 columns to fit nicely
  const MAX_COLS = 8;
  const dispHeaders = headers.slice(0, MAX_COLS);
  document.getElementById('stan-thead').innerHTML =
    '<tr>' + dispHeaders.map(h => `<th>${h}</th>`).join('') + '</tr>';

  document.getElementById('stan-tbody').innerHTML = rows.slice(0, 60).map(row =>
    '<tr>' + dispHeaders.map((h, i) => {
      const v = row[i];
      const isNum = typeof v === 'number';
      return `<td class="${isNum ? 'num-cell' : ''}" title="${v}">${isNum ? v.toLocaleString('pl-PL') : (v || '')}</td>`;
    }).join('') + '</tr>'
  ).join('');

  document.getElementById('stan-footer').textContent =
    'WyÅ›wietlono ' + Math.min(rows.length, 60) + ' z ' + rows.length + ' wierszy'
    + (headers.length > MAX_COLS ? ' Â· ' + (headers.length - MAX_COLS) + ' kolumn ukrytych' : '');
}

function clearStan() {
  localStorage.removeItem(LS_KEY);
  document.getElementById('stan-empty').style.display = 'block';
  document.getElementById('stan-data').style.display  = 'none';
  document.getElementById('stan-change-btn').style.display = 'none';
  document.getElementById('stan-badge').textContent = 'Brak danych';
  document.getElementById('mag-file').value = '';
}

// Load persisted data on init
(function() {
  try {
    const raw = localStorage.getItem(LS_KEY);
    if (!raw) return;
    const { date, headers, rows } = JSON.parse(raw);
    renderStan(date, headers, rows);
  } catch(e) {}
})();
</script>
</body>
</html>
