name: Regression Tests — OvocxMalinovi

on:
  push:
    branches:
      - main
      - 'claude/**'
  pull_request:
    branches: [main]

jobs:
  regression-tests:
    runs-on: ubuntu-latest
    name: Pełny suite testów regresji

    steps:
      - name: Checkout repozytorium
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: '[1/10] Smoke testy — dane JS'
        run: node tests/smoke.js

      - name: '[2/10] Dashboard WIG — integralność'
        run: node tests/dashboard.js

      - name: '[3/10] Nawigacja — linki HTML'
        run: node tests/navigation.js

      - name: '[4/10] Regression — ceny i marże'
        run: node tests/regression-prices.js

      - name: '[5/10] Regression — plany ilościowe'
        run: node tests/regression-plan.js

      - name: '[6/10] Regression — dostawcy i mapa kartonów'
        run: node tests/regression-suppliers.js

      - name: '[7/10] Regression — stany magazynowe'
        run: node tests/regression-inventory.js

      - name: '[8/10] Regression — spójność między plikami'
        run: node tests/regression-crossfile.js

      - name: '[9/10] Regression — dashboard rozszerzony'
        run: node tests/regression-crossfile-dashboard.js

      - name: '[10/10] Regression — rozliczenia RT'
        run: node tests/regression-rt.js

      - name: Podsumowanie
        if: success()
        run: |
          echo ""
          echo "████████████████████████████████████████████████████████"
          echo "  ✅  Wszystkie 10 suite'ów przeszły                    "
          echo "████████████████████████████████████████████████████████"
          echo ""
